<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    <link href="Styles/style.css" rel="stylesheet" />
    <script type="text/javascript" src="Scripts/jquery-2.0.3.min.js"></script>
    <script type="text/javascript" src="Scripts/common.js"></script>
    <script type="text/javascript" src="Scripts/graphics.js"></script>
    <script type="text/javascript" src="Scripts/lsystem.js"></script>
    <script type="text/javascript">
        $(function () {
            var canvas = $('#drawCanvas')[0];

            var cxt = canvas.getContext('2d');

            var w = canvas.width;
            var h = canvas.height;
            cxt.lineWidth = 1;
            cxt.strokeStyle = 'gray';

            cxt.beginPath();
            for (var x = 0; x < w; x += 10) {
                for (var y = 0; y < h; y += 10) {
                    cxt.moveTo(0, y);
                    cxt.lineTo(w, y);

                    cxt.moveTo(x, 0);
                    cxt.lineTo(x, h);
                }
            }
            cxt.stroke();
            cxt.closePath();

            var str = '';
            (function draw(expr, rules, depth) {
                if (depth == 0) return;
                depth -= 1;

                for (var i = 0; i < expr.length; i++) {
                    var c = expr[i];
                    var r = rules[c];
                    if (r) {
                        draw(r, rules, depth);
                    }

                    str += c;
                }
            })('F', { F: 'F[+F][-F][F]' }, 3);


            var g = new Graphics(canvas);
            var ls = new LSystem();
            //var expr = ls.generate('F', {
            //    F: 'F[+F][-F][F]'
            //}, 2);
            ls.draw(g, str);
        });

    </script>
</head>
<body>
    <canvas id="drawCanvas" width="600" height="600" class="canvas"></canvas>
</body>
</html>
